<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>Title</title>

    <style>
        @font-face {
            font-family: 'Cafe24Ssurround';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/Cafe24Ssurround.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
             font-family: 'S-CoreDream-3Light';
             src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_six@1.2/S-CoreDream-3Light.woff') format('woff');
             font-weight: normal;
             font-style: normal;
        }
        @font-face {
            font-family: 'LeeSeoyun';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2202-2@1.0/LeeSeoyun.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        :root {
            --color-background: #FFF7BB;
            --color-background-2: #B8E2E8;
            --color-point-1: #FFA3B5;
            --color-point-2: #6ED2C4;
            --color-point-3: #FBEB54;
            --color-black: #949494;
            --font-point: Cafe24Ssurround;
            --font-basic: S-CoreDream-3Light;
            --font-handwriting: LeeSeoyun;
        }
        body{
            background-image: url("/static/img/background.png");
        }
        .back {
            /* background-color: green; */
            font-family: var(--font-basic);
            font-size: 43px;
            margin-top: 43px;
            margin-left: 20px;
        }
        .title {
            /* background-color: red; */
            font-family: var(--font-point);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: 23px;
            margin-left: -9px;
            font-size: 33px;
        }

        .c_name {
            height: 50px;
            font-family: var(--font-basic);
            font-size: 44px;
            margin-top: -61px;
            margin-left: -200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .button {
            /* background-color: blue; */
            margin-top: 84px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

/*         .cake-choice-btn { */

        .cakeSelBtn {
            background-color: var(--color-point-1);
            border: none;
            text-align: center;
            width: 83%;
            height: 152px;
            border-radius: 40px;
            font-family: var(--font-basic);
            font-size: 62px;
            box-shadow: 3px 3px 3px black;
            transition-duration: 0.1s;
            color: white;
        }

/*         .cake-choice-btn:active { */

        .cakeSelBtn:active {
            margin-left: 5px;
            margin-top: 5px;
            box-shadow: none;
        }
        .container {
          width: 400vw;
          height: 400px;
          transition: transform 0.5s;
        }
        .inner {

          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;

          width: 100vw;
          height: 400px;
          float: left;
        }
        .inner img {
          background-color: white;
          width: 70%;
          height: 400px;
          border-radius: 80px;
        }
        .b_cake {
        /* background-color: orange; */
        width: 70%;
        height: 400px;
        margin-left: 200px;
        }
        .prev {
            font-size: 108px;
            width: 30px;
            margin-left: 102px;
            margin-top: -319px;
        }
        .next {
            font-size: 108px;
            margin-left: 845px;
            margin-top: -280px;
        }
        .controller {
            position: absolute;
            margin-top: 30px;
        }
        .title2 {
            font-family: var(--font-point);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: 23px;
            margin-left: -15px;
            font-size: 33px;
        }
        .title3 {
            font-family: var(--font-point);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: 23px;
            margin-left: 14px;
            font-size: 33px;
        }
        #nick {
            width: 815px;
            height: 168px;
            font-size: 76px;
            font-family: 'LeeSeoyun';
            border-radius: 40px;
            margin-left: 37px;
            border: none;
        }
        #b_day {
            width: 815px;
            font-size: 77px;
            font-family: 'LeeSeoyun';
            border-radius: 40px;
            margin-left: 13px;
            border: none;
            height: 168px;
        }

    </style>
    <script>
        {#로그인 화면으로 이동#}
        $(function(){
            $('.back-text').click(function(){
                location.href ='/login'
            })
        })

        {#슬라이드 관련 함수#}
        var count = 0
        $(function () {
            $(function change() {
                count++
                if (count % 2 != 0) {
                    $('#square1').attr('style', 'height: 685px')
                    $('#square1').attr('style', 'border: 8px solid var(--color-point-1)')
                } else if (count % 2 == 0) {
                    $('#square1').attr('style', 'height: 700px')
                    $('#square1').attr('style', 'border: white')
                }
            })
        })



        var cakes = [
            {'cake_id': 0, 'cake_name': 'strawberry' },
             {'cake_id': 1, 'cake_name': 'choco' },
             {'cake_id': 2, 'cake_name': 'sweetpotato' },
        ]

        var n_count = 0;
        $(function () {
            $('.next').click(function () {
                if (n_count == 0) {
                    $('.container').attr('style', 'transform: translate(-100vw)');
                    n_count = 1;
                } else if (n_count == 1) {
                    $('.container').attr('style', 'transform: translate(-200vw)');
                    n_count = 2;
                }
            })
        })
        $(function () {
            $('.prev').click(function () {
                if (n_count == 0) {
                    $('.container').attr('style', 'transform: translate(+0vw)');
                } else if (n_count == 1) {
                    $('.container').attr('style', 'transform: translate(+0vw)');
                    n_count = 0;
                } else if (n_count == 2) {
                    $('.container').attr('style', 'transform: translate(-100vw)');
                    n_count = 1;
                }
            })
        })

        {#케이크 선택 한 후 이동#}
        $(function() {
            $('.cakeSelBtn').click(function () {
                var current_cake = cakes.filter((cake) => cake.cake_id === n_count)
                var current_cake_name = current_cake[0]['cake_name']
                var nickname = $('#nick').val()
                var birthday = $('#b_day').val()

                {#/cake로 관련 정보 보내기#}
                console.log(current_cake_name, nickname, birthday)

                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();}

                let url

                $.ajax({
                    type: 'POST',
                    url: '/cake/makecake',

                    beforeSend: function (request) {
                        request.setRequestHeader( 'X-CSRF-TOKEN', getCookie('csrf_access_token'));
                        console.log(getCookie('csrf_access_token'));
                    },

                    data: {birth: birthday, user_nickname: nickname, cake_id: current_cake_name},
                    success: function (response) {
                        console.log(response);
                        url = response['url']
                        {#location.href =`/rolling/${url}`;#}
                    },
                    error: function (response) {
                        alert(response['responseJSON']['msg'])
                        console.log('there is an error!')
                        location.href =`/login`;
                    }
                }).then((arg) =>{
                    $.ajax({
                        type: "GET",
                        beforeSend: function (request) {
                            request.setRequestHeader('X-CSRF-TOKEN', getCookie('csrf_access_token'));
                            console.log(getCookie('csrf_access_token'));
                        },
                        url: "/rolling/check",
                        data: {},
                        success: function (response, testStatus, xhr) {
                            if (xhr.status == 200) {
                                location.href = "/rolling?key=" + url
                            } else {
                                location.href = '/login'
                            }
                        }
                    });
                })
            })
        })
    </script>
</head>
<body>

    <div class="goLogInBtn">
        <p>&nbsp < 로그인 화면으로</p>
    </div>

    <div class="title">
        <h1>케이크를 선택해주세요!</h1>
    </div>

<div>
    <div style="overflow: hidden;" >
        <div class="container">
              <div class="inner">

<!--                 <div class="b_cake choice1"><img src="/static/img/cake_strawberry.png" alt=""><p class="c_name"><b>딸기 케이크</b></p></div> -->

                  <div class="b_cake"><img src="/static/img/cake_strawberry.png" alt=""><p class="c_name"><b>딸기 케이크</b></p></div>

              </div>
            <div class="inner">
                <div class="b_cake choice2"><img src="/static/img/cake_choco.png" alt=""><p class="c_name"><b>초코 케이크</b></div>
            </div>
            <div class="inner">
                <div class="b_cake choice3"><img src="/static/img/cake_sweetpotato.png" alt=""><p class="c_name"><b>고구마 케이크</b></div>
            </div>
            <div class="inner">
                <div class="b_cake choice4"><img src="/static/img/cake_halloween.png" alt=""><p class="c_name"><b>할로윈 케이크</b></div>
            </div>
        </div>
    </div>
      <div class="controller">
            <p class="prev">&lang;</p>
            <p class="next">&rang;</p>
        </div>
</div>
     <div class="title2">
        <h1>닉네임을 입력해주세요!</h1>
         <input id="nick" type="text">
    </div>

    <div class="title3" >
        <h1>생년월일을 입력해주세요!</h1>
        <input id="b_day" type="date" min="1900-01-01" max="2022-12-31">
    </div>

    <div class="button">
        <button class="cakeSelBtn"><b>케이크 선택하기</b></button>
    </div>
</body>
</html>


<!--


    let n_count = 0;

    document.querySelector('.next').addEventListener('click', function(){
        let cake_transform = document.querySelector('.container').style.transform;
        let cake_location = Number(cake_transform.substr(cake_transform.indexOf('-'), 4));

        if (cake_location > -300) {
            cake_location = cake_location - 100;
            document.querySelector('.container').style.transform = `translate(${cake_location}vw)`;
        } else if (cake_transform == 'translate(0vw)') {
            cake_location = -100;
            document.querySelector('.container').style.transform = `translate(${cake_location}vw)`;
        }

        if(n_count < 3) {n_count++;
            }
    })

        document.querySelector('.prev').addEventListener('click', function(){
            let cake_transform = document.querySelector('.container').style.transform;
            let cake_location = Number(cake_transform.substr(cake_transform.indexOf('-'), 4));

            if (cake_location < 0) {
                cake_location = cake_location + 100;
            }
            document.querySelector('.container').style.transform = `translate(${cake_location}vw)`;
            if(n_count > 0) {n_count--; console.log(n_count, cake_location)}
        })


 -->

